
<!DOCTYPE html>
<html>
<head>
<meta name="robots" content="noindex, nofollow">
<style>
/* Performance Index Table Styles - Exact from hi.html */
.perf-table-container {
    width: 540px;
    margin: 0 auto;
}

.perf-table-container .position-selector {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 20px;
    margin-top: 5px;
    flex-wrap: wrap;
}

.perf-table-container .position-btn {
    padding: 8px 16px;
    background-color: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 6px;
    color: #374151;
    cursor: pointer;
    transition: all 0.2s ease;
    font-weight: 500;
    font-size: 0.9rem;
}

.perf-table-container .position-btn:hover {
    background-color: #f3f4f6;
    border-color: #d1d5db;
    color: #2563eb;
}

.perf-table-container .position-btn.active {
    background-color: #eff6ff;
    border-color: #2563eb;
    color: #2563eb;
    font-weight: 500;
}

.perf-table-container .position-content {
    display: none;
}

.perf-table-container .position-content.active {
    display: block;
}

.perf-table-container .metrics-container {
    background-color: #ffffff;
    border-radius: 8px;
    padding: 15px 20px 25px 20px;
    width: 540px;
    margin: 0 auto;
}

.perf-table-container .metrics-scroll-container {
    height: 490px;
    overflow-y: auto;
    margin-top: 0px;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    padding: 0 20px 0 0;
}

.perf-table-container .metrics-scroll-container > div {
    padding: 0 0 0 20px;
}

.perf-table-container .metrics-scroll-container::-webkit-scrollbar {
    width: 8px;
}

.perf-table-container .metrics-scroll-container::-webkit-scrollbar-track {
    background: #f3f4f6;
    border-radius: 4px;
    margin: 5px 0 0 0;
}

.perf-table-container .metrics-scroll-container::-webkit-scrollbar-track:empty {
    display: none;
}

.perf-table-container .metrics-scroll-container::-webkit-scrollbar-thumb {
    background: #d1d5db;
    border-radius: 4px;
}

.perf-table-container .metrics-scroll-container::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
}

.perf-table-container #goalkeeper .metrics-scroll-container::-webkit-scrollbar {
    width: 0px;
}

.perf-table-container #goalkeeper .metrics-scroll-container::-webkit-scrollbar-track {
    background: transparent;
}

.perf-table-container #goalkeeper .metrics-scroll-container::-webkit-scrollbar-thumb {
    background: transparent;
}

.perf-table-container .metric-item {
    display: flex !important;
    align-items: center !important;
    padding: 8px 0 !important;
    border-bottom: 1px solid #e5e7eb !important;
    gap: 20px !important;
    min-height: 32px !important;
    line-height: 1 !important;
    margin: 0 !important;
    height: auto !important;
}

.perf-table-container .metric-item:last-child {
    border-bottom: none !important;
}

.perf-table-container .metric-name {
    flex: 1 !important;
    font-size: 0.95rem !important;
    color: #374151 !important;
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    width: 100% !important;
    line-height: 1.2 !important;
    margin: 0 !important;
    padding: 0 !important;
}

.perf-table-container .metric-weight {
    font-weight: 600;
    color: #6b7280;
    min-width: 70px;
    text-align: right;
    font-size: 0.95rem;
    margin-left: auto;
}

.perf-table-container .weight-bar {
    width: 120px;
    height: 8px;
    background: #f3f4f6;
    border-radius: 4px;
    margin-left: 20px;
    overflow: hidden;
}

.perf-table-container .weight-fill {
    height: 100%;
    background: linear-gradient(90deg, #3b82f6, #2563eb);
    border-radius: 4px;
    transition: width 0.5s ease;
}

.perf-table-container .metric-name span {
    line-height: 1.2 !important;
    margin: 0 !important;
    padding: 0 !important;
    display: inline !important;
    height: auto !important;
    min-height: auto !important;
    max-height: none !important;
    vertical-align: baseline !important;
    font-size: 0.95rem !important;
}


/* Override any conflicting styles from the guide page */
.perf-table-container * {
    box-sizing: border-box !important;
}

.perf-table-container .metric-item,
.perf-table-container .metric-name,
.perf-table-container .metric-name span {
    font-family: inherit !important;
    line-height: inherit !important;
}

/* Force exact line-height and spacing */
.perf-table-container .metric-item {
    line-height: 1 !important;
    margin: 0 !important;
    padding: 8px 0 !important;
    height: auto !important;
    min-height: 32px !important;
    max-height: none !important;
    font-size: 0.95rem !important;
}

.perf-table-container .metric-name {
    line-height: 1.2 !important;
    margin: 0 !important;
    padding: 0 !important;
    height: auto !important;
    min-height: auto !important;
    max-height: none !important;
    font-size: 0.95rem !important;
}

.perf-table-container .metric-name span {
    line-height: 1.2 !important;
    margin: 0 !important;
    padding: 0 !important;
    height: auto !important;
    min-height: auto !important;
    max-height: none !important;
    display: inline !important;
    vertical-align: baseline !important;
    font-size: 0.95rem !important;
}

/* Override any global styles that might be affecting line-height */
.perf-table-container p,
.perf-table-container div,
.perf-table-container span {
    line-height: inherit !important;
}

/* Force the exact same styling as hi.html */
.perf-table-container {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif !important;
    line-height: 1.6 !important;
}

.perf-table-container .metrics-container {
    line-height: normal !important;
}

.perf-table-container .metrics-scroll-container {
    line-height: normal !important;
}

/* Disable scrolling for GK metrics */
.perf-table-container #goalkeeper .metrics-scroll-container {
    height: auto !important;
    overflow: visible !important;
    padding-right: 0 !important;
}

</style>
<div class="perf-table-container">
    <div id="goalkeeper" class="position-content active">
        <div class="metrics-container">
            <div class="position-selector">
                <button class="position-btn active" data-position="goalkeeper">GK</button>
                <button class="position-btn" data-position="centre-back">CB</button>
                <button class="position-btn" data-position="full-back">FB</button>
                <button class="position-btn" data-position="midfielder">CM</button>
                <button class="position-btn" data-position="winger">FW</button>
                <button class="position-btn" data-position="striker">ST</button>
            </div>
            <div class="metrics-scroll-container">
                <div id="goalkeeper-metrics"></div>
            </div>
        </div>
    </div>

    <div id="striker" class="position-content">
        <div class="metrics-container">
            <div class="position-selector">
                <button class="position-btn" data-position="goalkeeper">GK</button>
                <button class="position-btn" data-position="centre-back">CB</button>
                <button class="position-btn" data-position="full-back">FB</button>
                <button class="position-btn" data-position="midfielder">CM</button>
                <button class="position-btn" data-position="winger">FW</button>
                <button class="position-btn active" data-position="striker">ST</button>
            </div>
            <div class="metrics-scroll-container">
                <div id="striker-metrics"></div>
            </div>
        </div>
    </div>

    <div id="centre-back" class="position-content">
        <div class="metrics-container">
            <div class="position-selector">
                <button class="position-btn" data-position="goalkeeper">GK</button>
                <button class="position-btn active" data-position="centre-back">CB</button>
                <button class="position-btn" data-position="full-back">FB</button>
                <button class="position-btn" data-position="midfielder">CM</button>
                <button class="position-btn" data-position="winger">FW</button>
                <button class="position-btn" data-position="striker">ST</button>
            </div>
            <div class="metrics-scroll-container">
                <div id="centre-back-metrics"></div>
            </div>
        </div>
    </div>

    <div id="midfielder" class="position-content">
        <div class="metrics-container">
            <div class="position-selector">
                <button class="position-btn" data-position="goalkeeper">GK</button>
                <button class="position-btn" data-position="centre-back">CB</button>
                <button class="position-btn" data-position="full-back">FB</button>
                <button class="position-btn active" data-position="midfielder">CM</button>
                <button class="position-btn" data-position="winger">FW</button>
                <button class="position-btn" data-position="striker">ST</button>
            </div>
            <div class="metrics-scroll-container">
                <div id="midfielder-metrics"></div>
            </div>
        </div>
    </div>

    <div id="winger" class="position-content">
        <div class="metrics-container">
            <div class="position-selector">
                <button class="position-btn" data-position="goalkeeper">GK</button>
                <button class="position-btn" data-position="centre-back">CB</button>
                <button class="position-btn" data-position="full-back">FB</button>
                <button class="position-btn" data-position="midfielder">CM</button>
                <button class="position-btn active" data-position="winger">FW</button>
                <button class="position-btn" data-position="striker">ST</button>
            </div>
            <div class="metrics-scroll-container">
                <div id="winger-metrics"></div>
            </div>
        </div>
    </div>

    <div id="full-back" class="position-content">
        <div class="metrics-container">
            <div class="position-selector">
                <button class="position-btn" data-position="goalkeeper">GK</button>
                <button class="position-btn" data-position="centre-back">CB</button>
                <button class="position-btn active" data-position="full-back">FB</button>
                <button class="position-btn" data-position="midfielder">CM</button>
                <button class="position-btn" data-position="winger">FW</button>
                <button class="position-btn" data-position="striker">ST</button>
            </div>
            <div class="metrics-scroll-container">
                <div id="full-back-metrics"></div>
            </div>
        </div>
    </div>
</div>
<script>

  // Performance Index Table JavaScript - Exact from hi.html
  const positionData = {
      goalkeeper: [
          { name: "Prevented goals per 90", weight: 20.41 },
          { name: "Minutes played", weight: 16.33 },
          { name: "Save percentage %", weight: 14.29 },
          { name: "Clean sheets", weight: 10.20 },
          { name: "Passes completed per 90", weight: 10.20 },
          { name: "Pass completion %", weight: 4.08 },
          { name: "Short pass completion %", weight: 4.08 },
          { name: "Long pass accuracy %", weight: 4.08 },
          { name: "Short passes completed per 90", weight: 4.08 },
          { name: "Aerial duels won per 90", weight: 4.08 },
          { name: "Saves per 90", weight: 2.04 },
          { name: "Interceptions (PAdj)", weight: 2.04 },
          { name: "Defensive duels won per 90", weight: 2.04 },
          { name: "Long passes completed per 90", weight: 2.04 },
      ],
      striker: [
          { name: "Minutes played", weight: 9.35 },
          { name: "Non-penalty goals per 90", weight: 9.35 },
          { name: "Goals per 90", weight: 7.48 },
          { name: "Goals per 100 touches", weight: 6.54 },
          { name: "xG per 100 touches", weight: 6.54 },
          { name: "Shots per 90", weight: 4.67 },
          { name: "Assists per 90", weight: 4.67 },
          { name: "Key passes per 90", weight: 3.74 },
          { name: "npxG per 90", weight: 2.80 },
          { name: "Shots on target %", weight: 2.80 },
          { name: "Goal conversion %", weight: 2.80 },
          { name: "Touches in box per 90", weight: 2.80 },
          { name: "xA per 90", weight: 2.80 },
          { name: "Aerial duels won %", weight: 2.80 },
          { name: "xG per 90", weight: 1.87 },
          { name: "npxG/Shot", weight: 1.87 },
          { name: "Progressive carries per 90", weight: 1.87 },
          { name: "Offensive duels won per 90", weight: 1.87 },
          { name: "Goals - xG per 90", weight: 0.93 },
          { name: "Shots on target per 90", weight: 0.93 },
          { name: "Duels won per 90", weight: 0.93 },
          { name: "Progressive action rate", weight: 0.93 },
          { name: "Ball-carrying frequency", weight: 0.93 },
          { name: "Successful dribbles per 90", weight: 0.93 },
          { name: "Accelerations per 90", weight: 0.93 },
          { name: "Fouls suffered per 90", weight: 0.93 },
          { name: "xA per 100 passes", weight: 0.93 },
          { name: "Chance creation ratio", weight: 0.93 },
          { name: "Accurate crosses per 90", weight: 0.93 },
          { name: "Deep completions per 90", weight: 0.93 },
          { name: "Cross accuracy %", weight: 0.93 },
          { name: "Pass completion %", weight: 0.93 },
          { name: "Pass completion (to penalty box) %", weight: 0.93 },
          { name: "Passes completed per 90", weight: 0.93 },
          { name: "Possession +/-", weight: 0.93 },
          { name: "Possessions won - lost per 90", weight: 0.93 },
          { name: "Duels won %", weight: 0.93 },
          { name: "Interceptions (PAdj)", weight: 0.93 },
          { name: "Defensive duels won %", weight: 0.93 },
          { name: "Dribble success rate %", weight: 0.93 },
          { name: "Offensive duels won %", weight: 0.93 },
          { name: "Defensive duels won per 90", weight: 0.93 },
          { name: "Aerial duels won per 90", weight: 0.93 }
      ],
      "centre-back": [
          { name: "Minutes played", weight: 9.68 },
          { name: "Defensive duels won %", weight: 8.06 },
          { name: "Aerial duels won %", weight: 5.65 },
          { name: "Forward pass completion %", weight: 5.65 },
          { name: "Progressive passes completed per 90", weight: 5.65 },
          { name: "Progressive carries per 90", weight: 5.65 },
          { name: "Possession +/-", weight: 4.84 },
          { name: "Aerial duels won per 90", weight: 3.23 },
          { name: "Pass completion %", weight: 3.23 },
          { name: "Long pass accuracy %", weight: 3.23 },
          { name: "Passes completed per 90", weight: 3.23 },
          { name: "Forward passes completed per 90", weight: 3.23 },
          { name: "Interceptions (PAdj)", weight: 2.42 },
          { name: "Defensive duels won per 90", weight: 2.42 },
          { name: "Possessions won - lost per 90", weight: 2.42 },
          { name: "Progressive pass accuracy %", weight: 2.42 },
          { name: "Accurate passes to final third per 90", weight: 2.42 },
          { name: "Touches per 90", weight: 2.42 },
          { name: "Progressive action rate", weight: 2.42 },
          { name: "Possessions won per 90", weight: 1.61 },
          { name: "Interceptions per 90", weight: 1.61 },
          { name: "Short pass completion %", weight: 1.61 },
          { name: "Forward pass ratio", weight: 1.61 },
          { name: "Short passes completed per 90", weight: 1.61 },
          { name: "Long passes completed per 90", weight: 1.61 },
          { name: "Accurate passes to penalty box per 90", weight: 1.61 },
          { name: "Through passes completed per 90", weight: 1.61 },
          { name: "Progressive passes (PAdj)", weight: 1.61 },
          { name: "Key passes per 90", weight: 1.61 },
          { name: "Ball-carrying frequency", weight: 1.61 },
          { name: "Sliding tackles per 90", weight: 0.81 },
          { name: "Sliding tackles (PAdj)", weight: 0.81 },
          { name: "Goals per 90", weight: 0.81 },
          { name: "Headed goals per 90", weight: 0.81 },
          { name: "Successful dribbles per 90", weight: 0.81 }
      ],
      midfielder: [
          { name: "Minutes played", weight: 6.52 },
          { name: "Possession +/-", weight: 3.91 },
          { name: "Assists per 90", weight: 3.48 },
          { name: "Progressive passes completed per 90", weight: 3.48 },
          { name: "Touches per 90", weight: 3.04 },
          { name: "Forward pass completion %", weight: 3.04 },
          { name: "Progressive carries per 90", weight: 3.04 },
          { name: "Accurate crosses per 90", weight: 3.04 },
          { name: "Key passes per 90", weight: 2.61 },
          { name: "Defensive duels won %", weight: 2.61 },
          { name: "Aerial duels won %", weight: 2.61 },
          { name: "Duels won per 90", weight: 2.61 },
          { name: "Passes completed per 90", weight: 2.61 },
          { name: "Ball-carrying frequency", weight: 2.61 },
          { name: "Possessions won per 90", weight: 2.17 },
          { name: "Possessions won - lost per 90", weight: 2.17 },
          { name: "Interceptions (PAdj)", weight: 2.17 },
          { name: "Pass completion %", weight: 2.17 },
          { name: "Progressive pass accuracy %", weight: 2.17 },
          { name: "Forward passes completed per 90", weight: 2.17 },
          { name: "Progressive action rate", weight: 2.17 },
          { name: "Successful dribbles per 90", weight: 2.17 },
          { name: "npxG per 90", weight: 2.17 },
          { name: "Interceptions per 90", weight: 1.74 },
          { name: "xA per 90", weight: 1.74 },
          { name: "Shot assists per 90", weight: 1.74 },
          { name: "Non-penalty goals per 90", weight: 1.74 },
          { name: "Defensive duels won per 90", weight: 1.30 },
          { name: "Duels won %", weight: 1.30 },
          { name: "Forward pass ratio", weight: 1.30 },
          { name: "Short passes completed per 90", weight: 1.30 },
          { name: "Long passes completed per 90", weight: 1.30 },
          { name: "Accurate passes to final third per 90", weight: 1.30 },
          { name: "Through passes completed per 90", weight: 1.30 },
          { name: "Short pass completion %", weight: 1.30 },
          { name: "Long pass accuracy %", weight: 1.30 },
          { name: "xA per 100 passes", weight: 1.30 },
          { name: "Chance creation ratio", weight: 1.30 },
          { name: "Offensive duels won per 90", weight: 1.30 },
          { name: "Dribbles per 100 touches", weight: 1.30 },
          { name: "Goals per 100 touches", weight: 1.30 },
          { name: "xG per 100 touches", weight: 1.30 },
          { name: "Fouls suffered per 90", weight: 1.30 },
          { name: "Aerial duels won per 90", weight: 0.87 },
          { name: "Accurate passes to penalty box per 90", weight: 0.87 },
          { name: "Shots on target per 90", weight: 0.87 },
          { name: "Sliding tackles per 90", weight: 0.43 },
          { name: "Sliding tackles (PAdj)", weight: 0.43 },
          { name: "Accelerations per 90", weight: 0.43 },
          { name: "Progressive passes (PAdj)", weight: 0.43 },
          { name: "Pre-assists per 90", weight: 0.43 },
          { name: "Pass completion (to final third) %", weight: 0.43 },
          { name: "Pass completion (to penalty box) %", weight: 0.43 },
          { name: "Through pass completion %", weight: 0.43 },
          { name: "Cross accuracy %", weight: 0.43 },
          { name: "Dribble success rate %", weight: 0.43 },
          { name: "Offensive duels won %", weight: 0.43 }
      ],
      winger: [
          { name: "Minutes played", weight: 7.93 },
          { name: "Non-penalty goals per 90", weight: 6.10 },
          { name: "Assists per 90", weight: 6.10 },
          { name: "Successful dribbles per 90", weight: 5.49 },
          { name: "xA per 90", weight: 5.49 },
          { name: "Key passes per 90", weight: 5.49 },
          { name: "Goals per 90", weight: 4.88 },
          { name: "npxG per 90", weight: 4.88 },
          { name: "Accurate crosses per 90", weight: 4.88 },
          { name: "Offensive duels won per 90", weight: 4.27 },
          { name: "Progressive carries per 90", weight: 3.66 },
          { name: "Goals per 100 touches", weight: 3.05 },
          { name: "Shots on target per 90", weight: 3.05 },
          { name: "Touches per 90", weight: 3.05 },
          { name: "Progressive passes completed per 90", weight: 1.83 },
          { name: "Progressive action rate", weight: 1.83 },
          { name: "xG per 100 touches", weight: 1.83 },
          { name: "Goal conversion %", weight: 1.83 },
          { name: "Goals - xG per 90", weight: 1.83 },
          { name: "Possession +/-", weight: 1.83 },
          { name: "Ball-carrying frequency", weight: 1.22 },
          { name: "Dribbles per 100 touches", weight: 1.22 },
          { name: "Fouls suffered per 90", weight: 1.22 },
          { name: "Shot assists per 90", weight: 1.22 },
          { name: "Chance creation ratio", weight: 1.22 },
          { name: "Passes completed per 90", weight: 1.22 },
          { name: "Accurate passes to penalty box per 90", weight: 1.22 },
          { name: "Accelerations per 90", weight: 0.61 },
          { name: "Deep completions per 90", weight: 0.61 },
          { name: "xA per 100 passes", weight: 0.61 },
          { name: "Pre-assists per 90", weight: 0.61 },
          { name: "Long passes completed per 90", weight: 0.61 },
          { name: "Through passes completed per 90", weight: 0.61 },
          { name: "Pass completion %", weight: 0.61 },
          { name: "Pass completion (to penalty box) %", weight: 0.61 },
          { name: "Progressive pass accuracy %", weight: 0.61 },
          { name: "Shots on target %", weight: 0.61 },
          { name: "Cross accuracy %", weight: 0.61 },
          { name: "Dribble success rate %", weight: 0.61 },
          { name: "Offensive duels won %", weight: 0.61 },
          { name: "Interceptions (PAdj)", weight: 0.61 },
          { name: "Defensive duels won per 90", weight: 0.61 },
          { name: "Aerial duels won per 90", weight: 0.61 },
          { name: "Defensive duels won %", weight: 0.61 },
          { name: "Aerial duels won %", weight: 0.61 },
          { name: "Possessions won - lost per 90", weight: 0.61 },
          { name: "npxG/Shot", weight: 0.61 }
      ],
      "full-back": [
          { name: "Minutes played", weight: 6.36 },
          { name: "Progressive carries per 90", weight: 4.24 },
          { name: "xA per 90", weight: 4.24 },
          { name: "Defensive duels won %", weight: 4.24 },
          { name: "Aerial duels won %", weight: 4.24 },
          { name: "Successful dribbles per 90", weight: 4.24 },
          { name: "Accurate crosses per 90", weight: 4.24 },
          { name: "Offensive duels won per 90", weight: 4.24 },
          { name: "Progressive passes completed per 90", weight: 3.81 },
          { name: "Assists per 90", weight: 3.39 },
          { name: "Key passes per 90", weight: 3.39 },
          { name: "Ball-carrying frequency", weight: 2.97 },
          { name: "Long passes completed per 90", weight: 2.97 },
          { name: "npxG per 90", weight: 2.97 },
          { name: "Dribbles per 100 touches", weight: 2.54 },
          { name: "Progressive action rate", weight: 2.54 },
          { name: "Pass completion %", weight: 2.54 },
          { name: "Forward pass completion %", weight: 2.54 },
          { name: "Short pass completion %", weight: 2.54 },
          { name: "Possession +/-", weight: 2.54 },
          { name: "Accurate passes to final third per 90", weight: 2.54 },
          { name: "Accurate passes to penalty box per 90", weight: 2.54 },
          { name: "Interceptions (PAdj)", weight: 2.12 },
          { name: "Forward passes completed per 90", weight: 2.12 },
          { name: "xA per 100 passes", weight: 2.12 },
          { name: "Chance creation ratio", weight: 2.12 },
          { name: "Accelerations per 90", weight: 1.69 },
          { name: "Shot assists per 90", weight: 1.69 },
          { name: "Short passes completed per 90", weight: 1.69 },                
          { name: "Long pass accuracy %", weight: 1.69 },
          { name: "Progressive pass accuracy %", weight: 1.69 },
          { name: "Non-penalty goals per 90", weight: 1.69 },
          { name: "Cross accuracy %", weight: 1.27 },
          { name: "Possessions won per 90", weight: 0.85 },
          { name: "Sliding tackles (PAdj)", weight: 0.85 },
          { name: "Defensive duels won per 90", weight: 0.85 },
          { name: "Aerial duels won per 90", weight: 0.85 },
          { name: "Possessions won - lost per 90", weight: 0.42 },
          { name: "Progressive passes (PAdj)", weight: 0.42 }
      ]
  };

  // Function to convert metric display name to translation key
  function getMetricTranslationKey(displayName) {
      const mapping = {
          "Prevented goals per 90": "prevented_goals_per_90",
          "Minutes played": "minutes_played",
          "Save percentage %": "save_percentage",
          "Clean sheets": "clean_sheets",
          "Passes completed per 90": "passes_completed_per_90",
          "Pass completion %": "pass_completion",
          "Short pass completion %": "short_pass_completion",
          "Long pass accuracy %": "long_pass_accuracy",
          "Short passes completed per 90": "short_passes_completed_per_90",
          "Aerial duels won per 90": "aerial_duels_won_per_90",
          "Saves per 90": "saves_per_90",
          "Interceptions (PAdj)": "interceptions_padj",
          "Defensive duels won per 90": "defensive_duels_won_per_90",
          "Long passes completed per 90": "long_passes_completed_per_90",
          "Non-penalty goals per 90": "non_penalty_goals_per_90",
          "Goals per 90": "goals_per_90",
          "Goals per 100 touches": "goals_per_100_touches",
          "xG per 100 touches": "xg_per_100_touches",
          "Shots per 90": "shots_per_90",
          "Assists per 90": "assists_per_90",
          "Key passes per 90": "key_passes_per_90",
          "npxG per 90": "npxg_per_90",
          "Shots on target %": "shots_on_target_percentage",
          "Goal conversion %": "goal_conversion",
          "Touches in box per 90": "touches_in_box_per_90",
          "xA per 90": "xa_per_90",
          "Aerial duels won %": "aerial_duels_won_percentage",
          "xG per 90": "xg_per_90",
          "npxG/Shot": "npxg_per_shot",
          "Progressive carries per 90": "progressive_carries_per_90",
          "Offensive duels won per 90": "offensive_duels_won_per_90",
          "Goals - xG per 90": "goals_minus_xg_per_90",
          "Shots on target per 90": "shots_on_target_per_90",
          "Duels won per 90": "duels_won_per_90",
          "Progressive action rate": "progressive_action_rate",
          "Ball-carrying frequency": "ball_carrying_frequency",
          "Successful dribbles per 90": "successful_dribbles_per_90",
          "Accelerations per 90": "accelerations_per_90",
          "Fouls suffered per 90": "fouls_suffered_per_90",
          "xA per 100 passes": "xa_per_100_passes",
          "Chance creation ratio": "chance_creation_ratio",
          "Accurate crosses per 90": "accurate_crosses_per_90",
          "Deep completions per 90": "deep_completions_per_90",
          "Cross accuracy %": "cross_accuracy",
          "Pass completion (to penalty box) %": "pass_completion_to_penalty_box",
          "Possession +/-": "possession_plus_minus",
          "Possessions won - lost per 90": "possessions_won_lost_per_90",
          "Duels won %": "duels_won_percentage",
          "Defensive duels won %": "defensive_duels_won_percentage",
          "Dribble success rate %": "dribble_success_rate",
          "Offensive duels won %": "offensive_duels_won_percentage",
          "Forward pass completion %": "forward_pass_completion",
          "Progressive passes completed per 90": "progressive_passes_completed_per_90",
          "Forward passes completed per 90": "forward_passes_completed_per_90",
          "Progressive pass accuracy %": "progressive_pass_accuracy",
          "Accurate passes to final third per 90": "accurate_passes_to_final_third_per_90",
          "Touches per 90": "touches_per_90",
          "Possessions won per 90": "possessions_won_per_90",
          "Interceptions per 90": "interceptions_per_90",
          "Forward pass ratio": "forward_pass_ratio",
          "Accurate passes to penalty box per 90": "accurate_passes_to_penalty_box_per_90",
          "Through passes completed per 90": "through_passes_completed_per_90",
          "Progressive passes (PAdj)": "progressive_passes_padj",
          "Sliding tackles per 90": "sliding_tackles_per_90",
          "Sliding tackles (PAdj)": "sliding_tackles_padj",
          "Headed goals per 90": "headed_goals_per_90",
          "Shot assists per 90": "shot_assists_per_90",
          "Pre-assists per 90": "pre_assists_per_90",
          "Pass completion (to final third) %": "pass_completion_to_final_third",
          "Through pass completion %": "through_pass_completion",
          "Dribbles per 100 touches": "dribbles_per_100_touches"
      };
      return mapping[displayName] || displayName;
  }

  function renderMetrics(position) {
      const metrics = positionData[position];
      const container = document.getElementById(`${position}-metrics`);
      
      if (!container) return;
      
      container.innerHTML = '';
      
      // Find the highest weight for scaling
      const maxWeight = Math.max(...metrics.map(metric => metric.weight));
      
      metrics.forEach(metric => {
          const metricDiv = document.createElement('div');
          metricDiv.className = 'metric-item';
          
          const metricName = document.createElement('div');
          metricName.className = 'metric-name';
          
          const metricNameText = document.createElement('span');
          // Try to get translation, fallback to original name
          const translationKey = getMetricTranslationKey(metric.name);
          let displayName = metric.name;
          
          // Check if we have translations loaded
          if (window.translations && window.translations.metrics && window.translations.metrics[translationKey]) {
              displayName = window.translations.metrics[translationKey];
          }
          
          metricNameText.textContent = displayName;
          
          const weightBar = document.createElement('div');
          weightBar.className = 'weight-bar';
          
          const weightFill = document.createElement('div');
          weightFill.className = 'weight-fill';
          // Scale relative to the highest weight in this position
          weightFill.style.width = `${(metric.weight / maxWeight) * 100}%`;
          
          weightBar.appendChild(weightFill);
          metricName.appendChild(metricNameText);
          metricDiv.appendChild(metricName);
          metricDiv.appendChild(weightBar);
          container.appendChild(metricDiv);
      });
  }

  // Initialize Performance Index table
  document.addEventListener('DOMContentLoaded', function() {
      // Initialize goalkeeper metrics
      renderMetrics('goalkeeper');

      // Event listeners for position buttons
      document.querySelectorAll('.perf-table-container .position-btn').forEach(btn => {
          btn.addEventListener('click', () => {
              const position = btn.dataset.position;
              
              // Update active button across ALL position selectors
              document.querySelectorAll('.perf-table-container .position-btn').forEach(b => b.classList.remove('active'));
              document.querySelectorAll(`.perf-table-container [data-position="${position}"]`).forEach(b => b.classList.add('active'));
              
              // Update active content
              document.querySelectorAll('.perf-table-container .position-content').forEach(c => c.classList.remove('active'));
              const targetContent = document.querySelector(`.perf-table-container #${position}`);
              if (targetContent) {
                  targetContent.classList.add('active');
              }
              
              // Always re-render metrics to ensure translations are applied
              renderMetrics(position);
          });
      });

      // Render all positions on load
      Object.keys(positionData).forEach(position => {
          if (position !== 'goalkeeper') {
              renderMetrics(position);
          }
      });
  });
  </script>

<script>

    function getPreferredLanguage() {
      // PRIORITY 1: Check URL parameter first
      const urlParams = new URLSearchParams(window.location.search);
      const langParam = urlParams.get('lang');
      if (langParam) {
        return langParam;
      }
      // PRIORITY 2: Check localStorage
      const storedLang = localStorage.getItem('preferredLanguage');
      if (storedLang) {
        return storedLang;
      }
      // PRIORITY 3: Use browser language
      return getBrowserLanguage() || 'en';
    }
  
    function getBrowserLanguage() {
      return navigator.language.slice(0, 2);
    }
  
    function applyLanguage(language) {
      console.log(language);
  
      if (language === 'en') {
        // Clear translations for English
        window.translations = null;
        // Re-render all visible metrics
        const activePosition = document.querySelector('.perf-table-container .position-content.active');
        if (activePosition) {
          const positionId = activePosition.id;
          renderMetrics(positionId);
        }
        return;
      }
  
      fetch(`locales/${language}.json`)
        .then(response => {
          // Don't throw an error, just return null if response is not OK
          return response.ok ? response.json() : null;
        })
        .then(translations => {
          // Only proceed if translations exist
          if (translations) {
            // Store translations globally
            window.translations = translations;
            
            document.querySelectorAll('[data-i18n]').forEach(element => {
              const keys = element.getAttribute('data-i18n').split('.');
              let value = translations;
              for (const key of keys) {
                if (value === undefined || value === null) break;
                value = value[key];
              }
              if (value) {
                if (element.tagName === 'META') {
                element.setAttribute('content', value);
            } else if (value.includes('<')) {
                element.innerHTML = value;
            } else {
                element.textContent = value;
            }          }
            });
            
            // Re-render all visible metrics with new translations
            const activePosition = document.querySelector('.perf-table-container .position-content.active');
            if (activePosition) {
              const positionId = activePosition.id;
              renderMetrics(positionId);
            }
          }
        })
        .catch(() => {
          // Completely empty catch block to silently ignore any errors
        });
    }
    
    const preferredLanguage = getPreferredLanguage();
    applyLanguage(preferredLanguage);
    
      </script>
